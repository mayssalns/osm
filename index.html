<html>
  <head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" integrity="sha512-07I2e+7D8p6he1SIM+1twR5TIrhUQn9+I6yjqD53JQjFiMf8EtC93ty0/5vJTZGF8aAocvHYNEDJajGdNx1IsQ==" crossorigin=""/>
    
    <style>
      #map{
        background: #fff;
        border: none;
        height: 100%;
        width: 100%;

        box-sizing: border-box;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js" integrity="sha512-A7vV8IFfih/D732iSSKi20u/ooOfj/AGehOKq0f4vLT1Zr2Y+RX7C+w8A1gaSasGtRUZpF/NZgzSAu4/Gc41Lg==" crossorigin=""></script>

    <script>
      // initialize Leaflet

      var map = L.map('map').setView([0, 0], 8);

      // add the OpenStreetMap tiles
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>',
      }).addTo(map);

      // show the scale bar on the lower left corner
      L.control.scale({imperial: true, metric: true}).addTo(map);

      // Initial markers
      L.marker({lon: -46.680590 , lat: -23.599200 }).bindPopup('Drogaria').addTo(map);

      var circle = L.circle([0, 0], {
        color: '#1967D2',
        fillColor: '#1967D2',
        fillOpacity: 0.5,
        radius: 10
      }).addTo(map);
 

     

      function showLocation(position) {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
        console.log("Latitude : " + latitude + " Longitude: " + longitude)

        L.setLatLng([latitude, longitude])
      }

      function showInitialLocation(position) {
        console.log('POSITION', position)
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
        circle.setLatLng([latitude, longitude])
      }

      function errorHandler(err) {
        if(err.code == 1) {
            alert("Error: Access is denied!");
        } else if( err.code == 2) {
            alert("Error: Position is unavailable!");
        }
      }
			
      function watchPosition() {
        if(navigator.geolocation) {
            // timeout at 60000 milliseconds (60 seconds)
            var options = {timeout:60000};
            // navigator.geolocation.getCurrentPosition(showLocation, errorHandler, options);
            navigator.geolocation.watchPosition(showLocation, errorHandler, {timeout:60000}) 
        } else {
            alert("Sorry, browser does not support geolocation!");
        }
      }

      function getLocation() {
        if(navigator.geolocation) {
            // timeout at 60000 milliseconds (60 seconds)
            var options = {timeout:60000};
            navigator.geolocation.getCurrentPosition(showInitialLocation, errorHandler, options);
        } else {
            alert("Sorry, browser does not support geolocation!");
        }
      }

    
      watchPosition()

    

      document.addEventListener('DOMContentLoaded', function() {
        getLocation()
      })

    </script>

  <!-- <script type="text/javascript">
       var map = L.map('location-map').setView([	-1.4572002, -48.4653295], 17);
       mapLink = '<a href="https:openstreetmap.org">OpenStreetMap</a>';
       L.tileLayer(
         'https:{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
           attribution: 'Map data &copy; ' + mapLink,
           maxZoom: 20,
         }).addTo(map);
         L.tileLayer(
         'https:{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
           attribution: 'Map data &copy; ' + mapLink,
           maxZoom: 20,
         }).addTo(map);
         var marker = L.marker([-23.601650, -46.681740]).addTo(map);
     </script> -->
  </body>
</html>